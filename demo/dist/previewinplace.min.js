class PreviewInPlace{constructor(block,options){this.init(block,options)}init(block,options){let opts={previewGenerator:void 0,defaultIsPreview:!0,classPrefix:"",editValue:!1,loadDefaultCSS:!0,events:{onPreview:void 0,onEdit:void 0}};for(const[key,value]of Object.entries(opts))options[key]=void 0===options[key]?value:options[key];this._defaultIsPreview=options.defaultIsPreview,this._previewGeneratorCallback=options.previewGenerator,this._classPrefix=options.classPrefix,this._editValue=options.editValue,this._loadDefaultCSS=options.loadDefaultCSS,this._events=options.events,this._defaultCSS="."+this._classPrefix+"block{position:relative;display:grid}."+this._classPrefix+"block ."+this._classPrefix+"edit,."+this._classPrefix+"block ."+this._classPrefix+"preview{grid-column:1;grid-row:1}",this._injectDefaultCSS(),this._block=block,this._edit=block.querySelector("."+this._classPrefix+"edit"),this._preview=block.querySelector("."+this._classPrefix+"preview"),this._defaultIsPreview?this._editBlurred():this._blockClicked(),this._block.addEventListener("click",event=>{this._blockClicked(event)}),this._edit.addEventListener("blur",()=>{this._editBlurred()})}_injectDefaultCSS(){var styleTag;if(this._loadDefaultCSS&&null==document.head.querySelector("[data-fdsjkekwwriuehiucnjkdseje]")){var s=document.createElement("style");s.textContent=this._defaultCSS,s.setAttribute("data-fdsjkekwwriuehiucnjkdseje","");var firstChild=document.head.firstChild;document.head.insertBefore(s,firstChild)}}_blockClicked(event){void 0!==event&&event.stopPropagation(),void 0!==this._events.onEdit&&this._events.onEdit(),this._block.classList.add(this._classPrefix+"state-edit"),this._block.classList.remove(this._classPrefix+"state-preview"),this._edit.style.display="block",this._edit.focus(),this._preview.style.display="none",this._isInPreview=!1}_editBlurred(){void 0!==this._events.onPreview&&this._events.onPreview(),this._block.classList.remove(this._classPrefix+"state-edit"),this._block.classList.add(this._classPrefix+"state-preview"),this._edit.style.display="none",this._preview.innerHTML=this._previewGeneratorCallback(this._getEditValue()),this._preview.style.display="block",this._isInPreview=!0}_getEditValue(){return!1===this._editValue||void 0===this._editValue?this._edit.value:this._editValue()}set mode(mode){"edit"===mode.toLowerCase()?this._blockClicked():this._editBlurred()}get mode(){return this._isInPreview?"preview":"edit"}toggleMode(){"preview"==this.mode?this.mode="edit":this.mode="preview"}get editVal(){return this._getEditValue()}get previewVal(){return this._preview.innerHTML}get el(){return{block:this._block,edit:this._edit,preview:this._preview}}get options(){return{previewGenerator:this._previewGeneratorCallback,defaultIsPreview:this._defaultIsPreview,classPrefix:this._classPrefix,editValue:this._editValue,loadDefaultCSS:this._loadDefaultCSS}}}